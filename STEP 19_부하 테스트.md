# 부하 테스트 보고서

---

## 1. 개요
### 보고서 제목: 부하 테스트 대상 선정 및 목적, 시나리오 계획
### 작성일: 2024년 11월 29일
### 작성자: 김동하
### 테스트 대상 서비스:
- **유저 토큰 발급 / 조회 API**
- **예약 가능 날짜 / 좌석 API**
- **좌석 예약 요청 API**
- **잔액 충전 / 조회 API**
- **결제 API**

---

## 2. 부하 테스트의 목적
1. **시스템 안정성 검증**
   - 동시 사용자 증가에 따른 성능 저하 여부 확인.
   - 서버 리소스 (CPU, 메모리, 네트워크 등)의 효율성 검증.
2. **병목 구간 식별**
   - API별 처리량, 응답 속도 분석.
   - 데이터베이스 및 Redis 등의 외부 리소스에 대한 병목 확인.
3. **최대 처리 용량 확인**
   - 서비스가 처리 가능한 최대 동시 요청 수 도출.
4. **실제 운영 환경 준비**
   - 트래픽 패턴에 맞춘 확장성 및 용량 계획 수립.

---

## 3. 부하 테스트 대상 선정
### 1. 중요 테스트 대상
- **유저 토큰 발급 API**
  - 유저 대기열 번호를 폴링할 때 처리량이 많아지면 발생할 수 있는 성능 문제 확인.
- **좌석 예약 요청 API**
  - 경쟁적인 좌석 예약 처리에서 발생할 수 있는 충돌 및 성능 문제 확인.
- **결제 API**
  - 결제 요청은 시스템의 안정성과 트랜잭션 처리의 신뢰성이 요구됨.
  - 동시 다발적인 요청 상황에서 데이터 손실 또는 일관성 문제 확인.

---

## 4. 부하 테스트 시나리오

### 4.1 유저 대기열 순번 조회 시나리오
- **목표**: 10만 명의 사용자가 동시에 대기열 순번을 조회했을 때 처리 속도 확인.
- **가정**:
  - 10만 명의 사용자가 동시에 대기열 순번을 5초에 한 번씩 조회.
- **측정 지표**:
  1. 평균 응답 시간.
  2. 처리 속도.
- **예상**:
  - Redis를 사용하여 대기열을 관리하고 있으나 리스트가 너무 길어지기 때문에 속도 저하 우려.

### 4.2 좌석 예약 요청 API 시나리오
- **목표**: 100명 이상의 사용자가 동시에 좌석 예약 요청을 보낼 때 처리 속도 및 성공률 확인.
- **가정**:
  - 1명의 사용자가 좌석 선택 후 5초 내 요청.
  - 사용자가 동일 좌석을 선택할 가능성 존재.
- **측정 지표**:
  1. 성공/실패 비율.
  2. 평균 응답 시간.
  3. 처리 속도 (TPS: Transactions Per Second).
- **예상**:
  - 낙관적 락을 사용하여 관리하기 때문에 많은 요청이 몰리더라도 성공률 및 처리 속도에 영향 없음.

### 4.3 결제 API 시나리오
- **목표**: 결제 요청이 대규모로 들어올 경우 트랜잭션 처리의 안정성 검증.
- **가정**:
  - 100명의 사용자가 동시에 결제를 요청.
  - 트랜잭션 롤백 발생 여부 확인.
- **측정 지표**:
  1. 데이터 일관성.
  2. 평균 처리 시간.
  3. DB 및 외부 결제 API의 응답 시간.

---

## 5. 테스트 환경

### 서버 스펙
- **CPU**: 8 Core.
- **RAM**: 16GB.
- **네트워크 대역폭**: 1Gbps.

### 데이터베이스
- **MySQL**: InnoDB 엔진 사용.
- **Redis**: 캐싱 및 큐 관리.
- **Kafka**: 이벤트 발급 및 처리.

### 테스트 도구
- **k6**: 부하 테스트.
- **InfluxDB**: 테스트 데이터 수집.
- **Prometheus**: 테스트 데이터를 저장 및 분석.
- **Grafana**: 데이터 시각화 및 모니터링 대시보드.

---

## 6. 기대 효과
- 안정적인 사용자 경험 제공을 위한 API 성능 개선.
- 운영 환경에서 예상치 못한 장애 예방.
- 트래픽 증가 시 확장성을 보장할 수 있는 기반 마련.
